<template>

        <!-- SLDS Toast Container - Fixed positioning -->
    <template if:true={showToast}>
        <div class="slds-notify_container" style="top: 1rem; right: 1rem;">
                <div class="slds-notify slds-notify_toast" role="status" style={toastStyle}>
                <div class="slds-notify__content">
                    <h2 class="slds-text-heading_small">{toastTitle}</h2>
                    <p>{toastMessage}</p>
                </div>
            </div>
        </div>
    </template>


    <section role="dialog" class="slds-modal slds-fade-in-open" style="z-index: 1;">
        <div class="slds-modal__container">
            
            <!-- HEADER -->
            <header class="slds-modal__header">
                <h2 class="slds-text-heading_medium">Send List Email</h2>
                <button class="slds-button slds-button_icon slds-modal__close" 
                        title="Close" onclick={handleCancel}>
                    <lightning-icon icon-name="utility:close" alternative-text="close" size="small"></lightning-icon>
                </button>
            </header>

            <!-- BODY -->
            <div class="slds-modal__content slds-p-around_medium">
                <label class="slds-form-element__label">Recipients</label>
                    <lightning-pill-container items={recipients} onitemremove={handleItemRemove}></lightning-pill-container>
                <lightning-input 
                    label="Subject"
                    value={subject}
                    onchange={handleSubjectChange}>
                </lightning-input>

                <lightning-input-rich-text 
                    label="Content"
                    value={body}
                    onchange={handleBodyChange}>
                </lightning-input-rich-text>

            <!--File upload -->
                <lightning-file-upload
                    label="Attach Files"
                    name="fileUploader"
                    accept={acceptedFormats}
                    record-id={recordId}
                    onuploadfinished={handleUploadFinished}
                    multiple>
                </lightning-file-upload>

                                <!-- Show list of attached files -->
                <template if:true={attachedFiles.length}>
                    <div class="slds-m-top_medium">
                        <h3 class="slds-text-heading_small">Attached Files</h3>
                        <ul class="slds-list_dotted slds-m-left_medium">
                            <template for:each={attachedFiles} for:item="file">
                                <li key={file.documentId}>{file.name}</li>
                            </template>
                        </ul>
                    </div>
                </template>
            </div>

            <!-- FOOTER -->
            <footer class="slds-modal__footer">
                <lightning-button variant="brand" label="Send" onclick={handleSend}></lightning-button>
            </footer>
        </div>
    </section>

    <div class="slds-backdrop slds-backdrop_open" style="z-index: -1;"></div>
</template>